<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<style> 
 /* make it look pleasing!*/  
</style>
</head> 
<body>

<h1> Search for People!</h1>
  
  <h3 id="fileHeader"> Please enter in a list of people</h3>
<input type="file" id="myFile">
<button id="generateList"> Generate List! </button>

<p> Type in the name of the person you are looking for</p>
<input type="text" id="myInput" onkeyup="getPeople()" placeholder="Search for names.." title="Type in a name">
<div class="list">
  <ul id="myUL" onclick="profile()">
</div>
  
<!--   <dialog id="listOfPeople"> </dialog>
  <dialog id="personInfo"></dialog> -->
  
  <p>--------------------------------------------</p>
  
<script>
  //This block reads in a file and is supposed to create a new PersonList Object
  var input = document.getElementById("myFile");
  var listOfPeople;
  input.addEventListener("change", function () {
  if (this.files && this.files[0]) {
    var myFile = this.files[0];
    var reader = new FileReader();
    reader.addEventListener('load', function (e) {
      // if (reader) {
      //   debugger;
      // }
      //Here is where the PersonList object is created.
      listOfPeople = new PersonList("" + e.target.result);
    });
    reader.readAsBinaryString(myFile);
  }
});
  
  //I don't know if I'll keep this button, but for now it helps me see the PersonList
//object that was created.
$("#generateList").click(function() {
  console.log(listOfPeople);
  });
  
  //This generates the list of people that match what the user is typing
function getPeople() {
  var input, filter, ul, li, i, a, workingList;
  input = document.getElementById("myInput");
  filter = input.value.toLowerCase();
  ul = document.getElementById("myUL");
  li = document.createElement("li");
  // if (filter) {
  //   debugger;
  // }
  listOfPeople.setTitleConstraint(filter);
//For each person in listOfPeople, create a new list item on the document
  for(i = 0; i < listOfPeople.select().length; i++) {
    workingList = listOfPeople.select();
    li.appendChild(document.createTextNode(workingList[i].getName()));
    ul.appendChild(li);
  }
}
 
  //-------------------------------------Object Classes------------------------
 class Person {
  constructor (attributes) {
    var attr = attributes.split("\t");

    this.name = attr[0];
    this.address = attr[1];
    this.age = attr[2];
    this.interests = attr[3];
    this.picture = attr[4];
  }

  getName() {
    return this.name;
  }
  getAddress() {
    return this.address;
  }
  getAge() {
    return this.age;
  }
  getInterests() {
    return this.interests;
  }
  getPicture() {
    return this.picture;
  }
}

class PersonList {
  titleConstraint = "";
  constructor(people) {
    this.people = people.split("\n");
    this.allPeople = [];
    var lineNum = 0;
    var next = this.people.shift();
    while (next) {
      lineNum++;
      this.allPeople.push(new Person(next));
      next = this.people.shift();
    }

    this.setTitleConstraint("");
    this.allPeople.sort(function(a, b){return a.getName().localeCompare(b.getName())});

  }

  setTitleConstraint(title) {
    this.titleConstraint = title;
  }

  select() {
    var people = [];
    var items = this.allPeople;
    var i;
    for (i = 0; i < items.length; i++) {
      if (items[i].getName().toLowerCase().includes(this.titleConstraint.toLowerCase())) {
        people.push(items[i]);
      }
    }

   people.sort(function(a, b){return a.getName().localeCompare(b.getName())});
    return people;
  }

}
   
</script>
</body>
</html>
